# === TeslaAI Genesis RBAC RuleSet v2.9 ===
# Generated by: Evolver, ConflictResolver, Architectus + 20-agent council

agents:
  - id: booking_service_bot
    roles: [service_agent]
    permissions:
      - key:read
    constraints:
      - time_restricted: "06:00-22:00"
      - zone: "secure"
      - device_fingerprint: "trusted"
      - intent_required: true

  - id: telegram_client_agent
    roles: [external_auditor]
    permissions:
      - audit:read
    constraints:
      - zk_verified: true
      - origin_zone: "external"
      - entropy_score_min: 0.8
      - anomaly_score_max: 0.3

  - id: admin_console
    roles: [vault_admin]
    permissions:
      - key:create
      - key:delete
      - key:rotate
      - policy:reload
    constraints:
      - origin_ip_whitelisted: true
      - mfa_required: true
      - signed_request: true

  - id: ai_forensic_analyzer
    roles: [analyst_readonly]
    permissions:
      - key:read
      - audit:read
    constraints:
      - purpose: "security_review"
      - context.hash_verified: true
      - alert_mode_only: true

services:
  - name: "rotation_cronjob"
    type: "automated"
    roles: [service_agent]
    permissions:
      - key:rotate
    constraints:
      - schedule: "*/30 * * * *"
      - no_manual_override: true

  - name: "init_vault_script"
    type: "initialization"
    roles: [superadmin]
    permissions:
      - key:create
      - key:rotate
      - vault:seal
    constraints:
      - signature_required: true
      - executed_by: "root_user"
      - one_time: true

users:
  - username: root_user
    roles: [superadmin]
    permissions:
      - "*"
    constraints:
      - audit_all: true
      - session_timeout: "10m"
      - ip_lock: true

  - username: ai_guardian
    roles: [vault_admin]
    permissions:
      - key:rotate
      - key:delete
    constraints:
      - zero_trust_enforced: true
      - threat_score_max: 0.4
      - intent_signature_required: true

permission_sets:
  read_only:
    - key:read
    - audit:read

  full_admin:
    - "*"

  rotate_ops:
    - key:rotate
    - backup:create

intent_tags:
  - name: "security_review"
    purpose: "audit"
    required_signature: true
    min_entropy: 0.75
    anomaly_threshold_max: 0.3

  - name: "agent_boot"
    purpose: "automated_access"
    agent_verified: true
    ephemeral_token_required: true

meta:
  policy_revision: "2.9.1"
  version_date: "2025-08-01"
  audit_hash: "sha3_512_0x29fa..."
  signed_by:
    - "MetaGeneral:Architectus"
    - "MetaGeneral:Guardian"
    - "MetaGeneral:Evolver"
