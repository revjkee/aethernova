# === TeslaAI Genesis Key Rotation Schedule v3.0 ===
# Стратегия: AI-driven + Contextual Risk-Based Rotation + ZK-Ready

defaults:
  interval_days: 30
  enforcement: hard
  backup_before_rotate: true
  anomaly_triggered_rotation: true
  notify_channels:
    - "slack://security_ops"
    - "matrix://vault_alerts"
    - "email://crypto-admin@teslaai.com"

dynamic_triggers:
  - condition: "agent.anomaly_score > 0.7"
    action: "rotate_immediately"
    notify: true

  - condition: "entropy_drop_detected == true"
    action: "rotate_immediately"
    backup: true

  - condition: "context.zone == 'edge' and last_access > 30d"
    action: "deprecate_key"

profiles:
  high_risk:
    rotation_interval_days: 7
    allowed_usage: 1000 operations
    key_types: ["AES-256", "Ed25519", "PostQuantum"]
    constraints:
      - threat_score < 0.2
      - access_zone in ['core', 'secure']

  medium_risk:
    rotation_interval_days: 15
    key_types: ["AES-256", "GPG"]
    rotate_on_deviation: true
    constraints:
      - device_fingerprint in ['trusted', 'verified']
      - entropy_score >= 0.6

  low_risk:
    rotation_interval_days: 60
    key_types: ["XChaCha20", "RSA-2048"]
    allow_scheduled_skip: true
    skip_conditions:
      - context_hash_verified == true
      - no_alerts_last_90d == true

paths:
  - match: "crypto/*"
    profile: high_risk

  - match: "oauth_tokens/*"
    profile: medium_risk

  - match: "archives/*"
    profile: low_risk

  - match: "ai_agent_tokens/*"
    rotation_interval_days: 5
    agent_trust_threshold: 0.8
    revoke_on_anomaly: true
    auto_restore_from_backup: true

  - match: "devops/ephemeral/*"
    rotation_interval_minutes: 60
    auto_key_expiry: true
    enforce_session_bounds: true

quorum_policy:
  enabled: true
  threshold: 3
  approvers:
    - "root_user"
    - "ai_guardian"
    - "recovery_node"

zk_constraints:
  - match: "zk/identities/*"
    interval_days: 10
    enforce_zkproof_validity: true
    auto-rotate-if-zkey-expiring: true

meta:
  version: "3.0.2"
  revision_date: "2025-08-01"
  approved_by:
    - "MetaGeneral:Evolver"
    - "MetaGeneral:Guardian"
    - "MetaGeneral:Architectus"
  engine: "key_lifecycle + entropy_generator + anomaly_detector"
