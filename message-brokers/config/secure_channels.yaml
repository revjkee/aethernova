# message-brokers/config/secure_channels.yaml

version: "1.0"
audit_level_default: "standard"  # Возможные уровни: none, standard, strict, forensic
enforce_strict_encryption: true
default_encryption: "aes256-gcm"
signature_algorithm: "rsa-pss-sha256"
gpg_required: true
hmac_required: true
ai_guard_enabled: true
zero_trust_mode: true

trusted_key_sources:
  - "vault://genesis/secure-keys"
  - "file:///etc/genesis/keys/"
  - "gpg://genesis-master@secure.mesh"

channel_classes:
  critical:
    min_audit_level: "forensic"
    enforce_tls: true
    allowed_roles:
      - "admin"
      - "core-ai"
      - "infra-sec"
    required_tags:
      - "encrypted"
      - "signed"
      - "tamper-proof"
    key_rotation_days: 7
    mitm_protection: true

  sensitive:
    min_audit_level: "strict"
    enforce_tls: true
    allowed_roles:
      - "secure-agent"
      - "analytics-core"
    required_tags:
      - "encrypted"
      - "gpg-verified"
    key_rotation_days: 14

  standard:
    min_audit_level: "standard"
    allowed_roles:
      - "system"
      - "agent"
    encryption: "aes128-gcm"
    key_rotation_days: 30

  ephemeral:
    min_audit_level: "none"
    allowed_roles:
      - "healthcheck"
      - "heartbeat"
    encryption: "none"
    ttl_seconds: 60
    access_log: false

channels:
  - name: "alerts.critical"
    class: "critical"
    audit_level: "forensic"
    key_id: "gpg://alerts@genesis"
    enforce_signature: true
    ai_guard_class: "high"
    zero_trust_enforced: true

  - name: "telemetry.ai"
    class: "sensitive"
    audit_level: "strict"
    key_id: "vault://genesis/telemetry/key"
    enforce_signature: true
    ai_guard_class: "medium"

  - name: "agent.commands"
    class: "standard"
    audit_level: "standard"
    enforce_signature: false

  - name: "heartbeat.ping"
    class: "ephemeral"
    audit_level: "none"
    enforce_signature: false
    ttl_override: 30
