# Конфигурация сборки ISO образа Lab OS

iso_name: lab-os-secure
version: 1.0.0
release_date: 2025-07-14

architecture: x86_64
compression: xz
bootloader:
  type: grub2
  timeout: 5
  default_entry: 0
  secure_boot: true
  modules:
    - linux
    - linux16
    - part_msdos
    - ext2

kernel:
  version: 5.15.0
  config_file: /lab-os/kernel-configs/secure_kernel_config
  patches:
    - /lab-os/kernel-patches/security_hardening.patch
    - /lab-os/kernel-patches/memory_protection.patch

packages:
  mandatory:
    - coreutils
    - bash
    - systemd
    - openssh-server
    - auditd
    - firewalld
    - selinux-policy-targeted
    - iptables
    - sudo
    - ca-certificates
  optional:
    - vim
    - curl
    - wget

services:
  enabled:
    - sshd
    - auditd
    - firewalld
  disabled:
    - cups
    - avahi-daemon

network:
  firewall:
    enabled: true
    default_policy:
      input: drop
      output: accept
      forward: drop
    allowed_ports:
      - 22  # SSH
      - 443 # HTTPS

users:
  default_user:
    username: labadmin
    groups:
      - wheel
    password_hash: "$6$randomsalt$hashedpasswordhere"
    ssh_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEArandomkeyhere

logging:
  audit:
    enabled: true
    rules_file: /lab-os/security/audit.rules

build:
  scripts:
    pre_build: /lab-os/scripts/pre_build.sh
    post_build: /lab-os/scripts/post_build.sh
  output_directory: /lab-os/builds/iso

integrity:
  enable_signing: true
  signing_key: /lab-os/keys/iso_signing_key.pem

notes:
  - Все пакеты берутся из проверенных репозиториев с использованием подписей.
  - Используется SELinux в режиме enforcing.
  - Минимальный набор пакетов для безопасности и стабильности.
  - Включены патчи ядра для усиления безопасности и защиты памяти.
