
Общий обзор
Проект реализован в стиле микросервисов с разделением на три основных компонента:

Telegram бот — взаимодействие с пользователями через Telegram, обработка команд, запись клиентов.

FastAPI backend — REST API для управления данными: записи, мастера, таймслоты.

Фоновый воркер — обработка асинхронных задач, отправка уведомлений и других фоновых операций.

Данные хранятся в PostgreSQL, кэш и хранилище состояний — в Redis. Очередь сообщений реализована через Redis Pub/Sub.

Стек технологий
Python 3.13

aiogram 3.x — Telegram бот

FastAPI — backend API

Tortoise ORM + Aerich — асинхронная работа с PostgreSQL и миграции

Redis — кэш и FSM storage

Uvicorn + AsyncIO — асинхронный сервер и event loop

Docker (опционально) — для контейнеризации и упрощения деплоя

Структура проекта
backend/ — API и бизнес-логика

api/v1/ — маршруты REST API

models/ — модели ORM

services/ — сервисы с бизнес-логикой

database/ — миграции Alembic и конфиги БД

deps.py — зависимости для FastAPI

bot/ — Telegram бот

handlers/ — обработчики команд и сообщений

middlewares/ — middleware, например, для троттлинга

keyboards/ — inline и reply клавиатуры

router.py — настройка маршрутизации сообщений

core/ — основные компоненты и конфигурации

settings.py — конфигурации проекта

db.py — инициализация БД

message_queue.py — работа с очередью сообщений

entrypoints/ — точки входа для запуска

run_bot.py — запуск Telegram бота

run_api.py — запуск FastAPI backend

run_worker.py — запуск фонового воркера

utils/ — вспомогательные утилиты (валидация, планировщик, json энкодер и др.)

Ключевые принципы и подходы
Асинхронность на всех уровнях — для максимальной производительности и отзывчивости.

Разделение логики — бот, API и воркер запускаются раздельно, что позволяет масштабировать компоненты независимо.

Чистая архитектура — бизнес-логика отделена от API и интерфейса, что упрощает поддержку и расширение.

Использование Redis для кэша и состояния — ускоряет обработку и хранение сессий.

ORM и миграции — Tortoise ORM обеспечивает асинхронную работу с БД, Aerich — миграции.

Middleware и throttling — контроль нагрузки и защита от спама.

Минималистичный, но расширяемый дизайн — можно добавлять новые сервисы и API без сильных изменений.

Взаимодействия компонентов
Пользователь через Telegram взаимодействует с ботом.

Бот обращается к FastAPI API для получения/обновления данных (например, запись на слот).

API использует сервисы и ORM для доступа к базе.

Фоновые задачи (например, рассылка уведомлений) выполняются воркером через очередь сообщений.

Redis обеспечивает хранение состояний FSM и быструю очередь сообщений.

Преимущества
Высокая отзывчивость и масштабируемость.

Четкое разделение ответственности между компонентами.

Легко поддерживать и развивать проект.

Использование проверенных технологий и подходов.

Гибкая конфигурация через env и settings.

Ограничения и пути развития
Сложность конфигурации и мониторинга нескольких сервисов.

Необходимость навыков работы с асинхронностью.

Возможна доработка UI (Mini Apps) для улучшения UX.

Добавление авторизации и прав доступа.

Интеграция с платежными системами для монетизации.

Итог
Архитектура проекта построена с упором на устойчивость, масштабируемость и чистоту кода. Разделение Telegram бота, API и фонового воркера позволит гибко развивать и поддерживать проект, обеспечивая при этом высокую производительность и удобство для пользователей.