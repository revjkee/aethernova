apiVersion: v1
kind: Secret
metadata:
  name: engine-core-secrets
  namespace: backend
  labels:
    app: engine-core
    environment: production
    managed-by: gitops
  annotations:
    kubernetes.io/service-account.name: engine-core-sa
    secret.sync/target: "true" # для sync-контроллеров (optional)
    sealedsecrets.bitnami.com/managed: "true" # если используется SealedSecrets
    vault.hashicorp.com/agent-inject: "true"   # если используется Vault Agent Injector
    vault.hashicorp.com/role: "engine-core"
    vault.hashicorp.com/agent-inject-secret-ENV_FILE: "secret/data/engine-core"
    vault.hashicorp.com/agent-inject-template-ENV_FILE: |
      {{- with secret "secret/data/engine-core" -}}
      DB_PASSWORD={{ .Data.data.DB_PASSWORD }}
      API_KEY={{ .Data.data.API_KEY }}
      {{- end }}

type: Opaque
stringData:
  DB_PASSWORD: ${DB_PASSWORD}      # переменные окружения подставляются CI/CD или SealedSecrets
  API_KEY: ${API_KEY}
  JWT_SECRET: ${JWT_SECRET}
  TELEGRAM_TOKEN: ${TELEGRAM_TOKEN}
