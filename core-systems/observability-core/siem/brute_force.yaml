# observability/dashboards/siem/brute_force.yaml

rule_id: BRUTE_FORCE_001
description: >
  Detects brute force login attempts based on multiple failed authentication events
  from the same source IP within a short time window.

enabled: true
severity: high
tags:
  - authentication
  - brute-force
  - detection
  - anomaly
  - siem
  - security

conditions:
  type: threshold
  match:
    event_type: auth_failure
    group_by: source_ip
    timeframe_minutes: 5
    threshold: 10

actions:
  - type: alert
    message: >
      Potential brute force attack detected from IP {{ source_ip }} with {{ count }} failed logins in 5 minutes.
  - type: block
    target: source_ip
    duration_minutes: 30
  - type: log
    level: warning
    detail: true
