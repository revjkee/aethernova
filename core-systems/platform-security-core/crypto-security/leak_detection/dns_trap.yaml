# path: platform-security/code-protection/leak_detection/dns_trap.yaml

# TeslaAI DNS Honeypot Ruleset v1.20
# Назначение: создаёт ловушки для обнаружения утечек, проверяя DNS-запросы к уникальным субдоменам, встроенным в honeyfiles и отпечатки.
# Ловушки можно проверять через Bind, Unbound, CoreDNS, NextDNS или пассивный мониторинг DNS-логов SIEM.

dns_traps:
  - id: "honeyfile-access"
    fqdn: "honey01.sec.teslaai.internal"
    description: "Honeyfile opened in unauthorized context"
    severity: "critical"
    alert_type: "exfiltration_attempt"

  - id: "source-leak-scan"
    fqdn: "srcleak47.dev.teslaai.internal"
    description: "Source code scanned or fingerprinted by unknown actor"
    severity: "high"
    alert_type: "reconnaissance"

  - id: "ci-leak-build"
    fqdn: "buildleak.ci.teslaai.internal"
    description: "Leak occurred during CI/CD or runner-level access"
    severity: "high"
    alert_type: "compromise"

  - id: "external-access-honeytoken"
    fqdn: "extaccess.token.teslaai.internal"
    description: "External environment accessed embedded token domain"
    severity: "critical"
    alert_type: "external_exfiltration"

  - id: "internal-misuse"
    fqdn: "internalleak.teslaai.local"
    description: "Unexpected internal actor touched honey asset"
    severity: "medium"
    alert_type: "internal_risk"

trap_config:
  passive_dns_logging: true
  log_sink: "/var/log/teslaai/dns_trap_alerts.log"
  syslog_forwarding: true
  notify_channels:
    - type: "slack"
      webhook: "https://hooks.slack.com/services/TXXXXX/BXXXX/XXXXXXXX"
    - type: "email"
      to: "sec-ops@teslaai.local"

integrations:
  - siem: "Splunk"
  - siem: "Wazuh"
  - dns_provider: "CoreDNS"
  - dns_provider: "NextDNS"
  - dns_provider: "Bind"
