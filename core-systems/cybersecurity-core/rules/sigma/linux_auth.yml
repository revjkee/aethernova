title: Linux SSH Authentication Failures (Possible Brute Force)
id: 9c7e3b3e-4a2a-4c28-b9b2-2b7a8c7b5a10
status: stable
description: Detects failed SSH authentication attempts and invalid users which can indicate brute force or credential stuffing.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: sshd
detection:
  selection_failed_password:
    syslog.program|contains: "sshd"
    message|contains:
      - "Failed password"
      - "authentication failure"
  selection_invalid_user:
    syslog.program|contains: "sshd"
    message|contains:
      - "Invalid user"
      - "user unknown"
  condition: selection_failed_password or selection_invalid_user
fields:
  - @timestamp
  - host.name
  - source.ip
  - source.port
  - user.name
  - process.name
  - syslog.program
  - event.original
falsepositives:
  - Legitimate users mistyping passwords
  - Security scans against SSH
level: medium
tags:
  - attack.T1110
  - attack.T1110.001
  - attack.T1110.003
---
title: Linux SSH Successful Root Login
id: e1f6ae6d-9a7c-4b6a-bb2d-6a1b3b0b5a22
status: stable
description: Detects successful SSH logins for root which should be rare in hardened environments.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: sshd
detection:
  selection_root_accepted:
    syslog.program|contains: "sshd"
    message|contains|all:
      - "Accepted"
      - "for root"
  condition: selection_root_accepted
fields:
  - @timestamp
  - host.name
  - source.ip
  - source.port
  - user.name
  - process.name
  - event.original
falsepositives:
  - Intended administrative root logins (should be controlled and rare)
level: high
tags:
  - attack.T1078
---
title: Linux su to root (Success or Failure)
id: b2b1a2c9-2a9f-4b8e-9d8a-2a3f0a5f7c33
status: stable
description: Detects attempts to switch user to root using su, both successful and failed.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: syslog
detection:
  selection_su_opened:
    syslog.program|contains: "su"
    message|contains:
      - "session opened for user root"
      - "Successful su for root"
  selection_su_failed:
    syslog.program|contains: "su"
    message|contains:
      - "FAILED su for root"
      - "authentication failure"
  condition: selection_su_opened or selection_su_failed
fields:
  - @timestamp
  - host.name
  - user.name
  - source.ip
  - process.name
  - event.original
falsepositives:
  - Legitimate break-glass procedures
level: high
tags:
  - attack.T1078
  - attack.T1059.004
---
title: Linux sudo Authentication Failures
id: 5a6d2f99-0e2e-4b3c-9f12-2a0b9ac7d444
status: stable
description: Detects sudo authentication failures that may indicate password guessing or privilege escalation attempts.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: syslog
detection:
  selection_sudo_fail:
    syslog.program|contains: "sudo"
    message|contains:
      - "authentication failure"
      - "user NOT in sudoers"
      - "incorrect password attempts"
  condition: selection_sudo_fail
fields:
  - @timestamp
  - host.name
  - user.name
  - source.ip
  - process.name
  - event.original
falsepositives:
  - User typos during sudo
level: medium
tags:
  - attack.T1110
  - attack.T1078
---
title: Linux Local User Created (useradd/adduser)
id: 4b1a9e2f-2b6a-4e5b-9c2f-6a7b2c9d5555
status: stable
description: Detects creation of a new local user via useradd/adduser which may be used for persistence.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: syslog
detection:
  selection_useradd:
    syslog.program|contains:
      - "useradd"
      - "adduser"
  selection_messages:
    message|contains:
      - "new user"
      - "added user"
      - "creating home directory"
      - "adduser"
      - "useradd"
  condition: selection_useradd and selection_messages
fields:
  - @timestamp
  - host.name
  - user.name
  - process.name
  - event.original
falsepositives:
  - Legitimate provisioning by configuration management
level: high
tags:
  - attack.T1098
---
title: Linux User Added to Privileged Group (sudo/wheel)
id: 7c8d2a1e-3f4a-4c9b-8a7b-1d2e3f4a6666
status: stable
description: Detects a local user being granted sudo/wheel privileges via usermod/gpasswd, indicating privilege escalation or persistence.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: syslog
detection:
  selection_usermod:
    syslog.program|contains:
      - "usermod"
      - "gpasswd"
  selection_priv_groups:
    message|contains:
      - "sudo"
      - "wheel"
      - "adm"
  condition: selection_usermod and selection_priv_groups
fields:
  - @timestamp
  - host.name
  - user.name
  - process.name
  - event.original
falsepositives:
  - Legitimate admin role assignment
level: high
tags:
  - attack.T1098
  - attack.T1078
---
title: Linux PAM Account Locked (faillock/tally)
id: 8d2f3c4b-5a6d-4e7f-9a1b-2c3d4e5f7777
status: stable
description: Detects PAM account lock events (pam_faillock or pam_tally2) often following brute-force attempts.
author: Aethernova CSIRT
date: 2025/09/02
logsource:
  product: linux
  category: authentication
  service: syslog
detection:
  selection_faillock:
    message|contains:
      - "pam_faillock"
      - "Account temporarily locked"
      - "authentication failure; logname="
      - "tally"
      - "Too many authentication failures"
  condition: selection_faillock
fields:
  - @timestamp
  - host.name
  - user.name
  - source.ip
  - syslog.program
  - event.original
falsepositives:
  - Misconfigured PAM policies
level: medium
tags:
  - attack.T1110
