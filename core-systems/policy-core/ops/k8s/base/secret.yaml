---
apiVersion: v1
kind: Secret
metadata:
  name: policy-core-secrets
  namespace: policy-core
  labels:
    app.kubernetes.io/name: policy-core
    app.kubernetes.io/component: core
    app.kubernetes.io/part-of: policy-core
    app.kubernetes.io/managed-by: gitops
  annotations:
    reloader.stakater.com/match: "true"   # если используется Reloader для рестарта подов при обновлении секрета
    kubernetes.io/change-cause: "bootstrap base secret"
type: Opaque
immutable: true
stringData:
  # Заполните значения через ваш процесс CI/CD / Kustomize / SOPS
  DB_URL: ""                 # пример: postgresql://user:pass@db:5432/policy_core
  OIDC_CLIENT_ID: ""
  OIDC_CLIENT_SECRET: ""
  JWT_SIGNING_KEY: ""        # случайная строка 32+ символов
  OPA_BUNDLE_TOKEN: ""
  SENTRY_DSN: ""
  # Добавьте при необходимости другие ключи приложения

---
apiVersion: v1
kind: Secret
metadata:
  name: policy-core-regcred
  namespace: policy-core
  labels:
    app.kubernetes.io/name: policy-core
    app.kubernetes.io/component: image-pull
    app.kubernetes.io/part-of: policy-core
    app.kubernetes.io/managed-by: gitops
  annotations:
    kubernetes.io/change-cause: "registry credentials"
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: |
    {
      "auths": {
        "https://index.docker.io/v1/": {
          "username": "<username>",
          "password": "<password>",
          "auth": "<base64(username:password)>"
        }
      }
    }

---
apiVersion: v1
kind: Secret
metadata:
  name: policy-core-tls
  namespace: policy-core
  labels:
    app.kubernetes.io/name: policy-core
    app.kubernetes.io/component: tls
    app.kubernetes.io/part-of: policy-core
    app.kubernetes.io/managed-by: gitops
  annotations:
    kubernetes.io/change-cause: "tls certificate for ingress/webhook"
type: kubernetes.io/tls
stringData:
  tls.crt: |-
    -----BEGIN CERTIFICATE-----
    MIIB...REPLACE_WITH_YOUR_CERT...Q==
    -----END CERTIFICATE-----
  tls.key: |-
    -----BEGIN PRIVATE KEY-----
    MIIE...REPLACE_WITH_YOUR_KEY...Q==
    -----END PRIVATE KEY-----
