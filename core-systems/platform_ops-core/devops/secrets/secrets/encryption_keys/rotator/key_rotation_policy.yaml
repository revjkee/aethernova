# Key Rotation Policy - TeslaAI Genesis Infrastructure
# Applies to: GPG, Vault Transit, AWS KMS, GCP KMS

version: 1.0
policy:
  rotation_interval_days: 90
  grace_period_days: 15
  notify_channels:
    - ops-alerts@teslaai.io
    - telegram://devops_team_channel
  keys:
    gpg:
      enabled: true
      expiration_days: 365
      backup_before_rotation: true
      validation:
        - verify_fingerprint
        - test_sign_and_encrypt
    vault_transit:
      enabled: true
      rotate_command: vault write -f transit/keys/master/rotate
      rewrap_secrets: true
      test_decrypt_after_rotation: true
    aws_kms:
      enabled: true
      rotation_enabled: true
      key_alias_prefix: "alias/teslaai/"
      reencrypt_resources: true
    gcp_kms:
      enabled: true
      rotation_schedule:
        period: 90d
        next_rotation_time: auto
      reencrypt_required: true
  audit:
    enable_rotation_logging: true
    log_file: /devops/secrets/encryption_keys/audit/key_access.log
    hash_check_after_rotation: true
  rollback_protection:
    keep_previous_versions: 2
    rollback_command: ./rotator/rollback.sh
    validate_on_restore: true
