# intel-core/correlation-engine/rules/detection_rules.yaml

# Пример правил обнаружения угроз в формате YAML
rules:
  - id: rule_001
    name: "Multiple Failed Logins"
    description: "Обнаружение множества неудачных попыток входа в систему с одного IP"
    conditions:
      event_type: "login_failure"
      threshold: 5        # Количество неудач для срабатывания
      time_window: 300    # Временной интервал в секундах (5 минут)
    actions:
      - alert: "High"
      - notify_team: true

  - id: rule_002
    name: "Suspicious Domain Access"
    description: "Доступ к подозрительным доменам из черного списка"
    conditions:
      event_type: "dns_request"
      domain_in_list: "blacklist_domains"
    actions:
      - alert: "Critical"
      - block_connection: true

  - id: rule_003
    name: "New User Agent Detected"
    description: "Обнаружение новых, ранее не встречавшихся user-agent"
    conditions:
      event_type: "http_request"
      user_agent_new: true
    actions:
      - alert: "Medium"
      - log: true

  - id: rule_004
    name: "High Volume Data Transfer"
    description: "Передача большого объема данных за короткий период"
    conditions:
      event_type: "data_transfer"
      volume_threshold: 1000000000  # в байтах (пример 1 ГБ)
      time_window: 600              # 10 минут
    actions:
      - alert: "High"
      - notify_team: true
