version: "1.0"
description: >
  Правила эволюции для всех мутационных стратегий TeslaAI. Используется в mutation_engine,
  guided_mutation, optimizer и mutation_core.

parameters:
  learning_rate:
    type: float
    range: [0.00001, 0.01]
    step: auto
    allow_mutation: true

  dropout:
    type: float
    range: [0.0, 0.5]
    allow_mutation: true

  num_layers:
    type: int
    range: [1, 12]
    allow_mutation: true

  batch_size:
    type: int
    values: [32, 64, 128, 256, 512]
    allow_mutation: true

  activation:
    type: categorical
    values: ["relu", "tanh", "gelu", "swish"]
    blacklist: ["sigmoid"]

  optimizer:
    type: categorical
    values: ["adam", "adamw", "sgd", "rmsprop"]
    priority_order: ["adamw", "adam", "rmsprop", "sgd"]

  hidden_dim:
    type: int
    range: [64, 2048]
    step: 64
    allow_mutation: true

constraints:
  disallowed_combinations:
    - [activation: "gelu", optimizer: "sgd"]
    - [dropout: 0.5, num_layers: 1]

  parameter_dependencies:
    - if: "hidden_dim > 1024"
      then: "optimizer in ['adamw', 'rmsprop']"
    - if: "learning_rate < 0.0001"
      then: "batch_size >= 128"

strategies:
  allowed:
    - random
    - greedy
    - guided
    - coevolution
  default: guided

mutation_control:
  max_mutation_depth: 3
  mutation_retry_limit: 5
  early_stop_threshold: 0.95
  confidence_filtering: true
  lineage_enforcement: true
  enforce_generation_gap: 2

tags:
  critical_parameters: ["learning_rate", "num_layers", "hidden_dim"]
  experimental_combinations:
    - ["activation:swish", "optimizer:adamw"]
    - ["dropout:0.1", "num_layers:10"]

audit:
  rule_updated: "2025-08-01T00:00:00Z"
  reviewed_by:
    - "MetaGeneral-001"
    - "MetaGeneral-003"
    - "EvolutionaryCouncil-A"
