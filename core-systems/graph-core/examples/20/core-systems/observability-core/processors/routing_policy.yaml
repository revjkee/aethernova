# observability/dashboards/processors/routing_policy.yaml

default:
  handlers:
    - stdout
    - loki
  level: info
  format: json

rules:
  - match:
      severity: critical
    route:
      handlers:
        - sentry
        - siem
        - slack_alert
      format: red_team
      level: error

  - match:
      service: auth-service
    route:
      handlers:
        - kafka
        - file
      format: json
      level: debug

  - match:
      env: production
      trace: true
    route:
      handlers:
        - jaeger
        - elk
      format: otel
      level: info

  - match:
      pii_detected: true
    route:
      handlers:
        - sentinel
        - audit_log
      format: custom
      level: warning

  - match:
      latency_ms: ">=1000"
    route:
      handlers:
        - prometheus
        - alertmanager
      format: latency
      level: warning

  - match:
      source: honeypot
    route:
      handlers:
        - xdr
        - syslog
      format: red_team
      level: critical
