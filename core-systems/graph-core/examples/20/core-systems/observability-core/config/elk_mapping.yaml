# Elastic Common Schema (ECS) mapping для логов
mappings:
  dynamic_templates:
    - strings_as_keyword:
        match_mapping_type: string
        mapping:
          type: keyword
  properties:
    timestamp:
      type: date
      format: strict_date_optional_time||epoch_millis
    log:
      properties:
        level:
          type: keyword
        logger:
          type: keyword
        origin:
          properties:
            file:
              type: keyword
            line:
              type: integer
            function:
              type: keyword
    message:
      type: text
      fields:
        keyword:
          type: keyword
    host:
      properties:
        hostname:
          type: keyword
        ip:
          type: ip
    event:
      properties:
        dataset:
          type: keyword
        module:
          type: keyword
        severity:
          type: integer
    user:
      properties:
        id:
          type: keyword
        name:
          type: keyword
    process:
      properties:
        pid:
          type: integer
        name:
          type: keyword
    source:
      properties:
        ip:
          type: ip
        port:
          type: integer
    tags:
      type: keyword
