{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Log Entry Schema",
  "description": "Unified schema for ECS/OTEL-compatible structured log entry",
  "type": "object",
  "properties": {
    "@timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Time when the event occurred"
    },
    "severity": {
      "type": "string",
      "enum": ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"],
      "description": "Log severity level"
    },
    "message": {
      "type": "string",
      "description": "Full log message"
    },
    "service": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "version": { "type": "string" },
        "environment": { "type": "string" }
      },
      "required": ["name"]
    },
    "host": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "ip": { "type": "string" }
      }
    },
    "event": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "dataset": { "type": "string" },
        "module": { "type": "string" },
        "action": { "type": "string" }
      }
    },
    "process": {
      "type": "object",
      "properties": {
        "pid": { "type": "integer" },
        "thread_id": { "type": "integer" },
        "name": { "type": "string" }
      }
    },
    "log": {
      "type": "object",
      "properties": {
        "level": { "type": "string" },
        "logger": { "type": "string" },
        "origin": {
          "type": "object",
          "properties": {
            "file": { "type": "string" },
            "line": { "type": "integer" },
            "function": { "type": "string" }
          }
        }
      }
    },
    "trace": {
      "type": "object",
      "properties": {
        "id": { "type": "string" }
      }
    },
    "span": {
      "type": "object",
      "properties": {
        "id": { "type": "string" }
      }
    },
    "labels": {
      "type": "object",
      "description": "Custom structured key-value fields"
    },
    "ecs": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "const": "1.12.0"
        }
      },
      "required": ["version"]
    }
  },
  "required": ["@timestamp", "severity", "message", "service", "ecs"],
  "additionalProperties": true
}
