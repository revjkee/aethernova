# observability/dashboards/siem/exfiltration.yaml

rule_id: DATA_EXFIL_003
description: >
  Detects potential data exfiltration based on abnormal outbound traffic volume, protocol usage, and destination characteristics.

enabled: true
severity: high
tags:
  - exfiltration
  - data-theft
  - siem
  - anomaly
  - network-security
  - mitre_technique:T1041

conditions:
  type: composite
  match:
    - field: outbound_bytes
      operator: greater_than
      value: 50000000  # 50MB
      timeframe_minutes: 5

    - field: protocol
      operator: in
      value:
        - https
        - ftp
        - sftp
        - dns

    - field: destination_geo
      operator: not_in
      value:
        - RU
        - KZ
        - BY
        - UZ

    - field: destination_asn_reputation
      operator: less_than
      value: 30

exceptions:
  - allowlisted_ips:
      - "203.0.113.0/24"
      - "198.51.100.0/24"

actions:
  - type: alert
    message: >
      Potential data exfiltration detected from {{ source_ip }} to {{ destination_ip }}. Transferred {{ outbound_bytes }} bytes over {{ protocol }}.

  - type: isolate
    target: source_ip
    duration_minutes: 60

  - type: ticket
    system: JIRA
    project_key: SOC
    priority: P1
    summary: Data Exfiltration Alert - {{ source_ip }}
