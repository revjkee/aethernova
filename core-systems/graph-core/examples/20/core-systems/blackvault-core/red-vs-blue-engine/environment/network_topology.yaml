version: 2.0
description: |
  Индустриальная топология корпоративной сети для симуляции Red/Blue AI.
  Поддерживает:
    - сегментированные зоны (DMZ, внутренняя, SCADA)
    - маршруты обхода и уязвимости
    - критичные узлы и цели
    - сенсоры и HoneyNodes
    - шлюзы и межсетевые фильтры

zones:
  - id: dmz
    label: DMZ (публичная зона)
    firewall: true
    nodes:
      - id: web_server_1
        type: web_server
        os: ubuntu_22
        services: [nginx, ssh]
        exposure: external
        tags: [http, entrypoint]
        honeypot: false

      - id: reverse_proxy
        type: proxy
        os: alpine
        services: [haproxy]
        linked_to: [web_server_1]
        exposure: internal
        tags: [lateral]

  - id: internal
    label: Внутренняя зона
    firewall: true
    nodes:
      - id: db_server
        type: database
        os: debian
        services: [postgresql]
        tags: [critical, data, lateral]
        credentials_leak: true

      - id: ad_server
        type: active_directory
        os: windows_server_2022
        services: [ldap, kerberos]
        tags: [privilege_escalation, lateral]
        weak_passwords: true

      - id: siem_sensor
        type: sensor
        os: custom
        services: [osquery, syslog]
        role: detection
        tags: [blue_team, monitoring]
        honeypot: false

  - id: scada
    label: SCADA сегмент
    firewall: true
    nodes:
      - id: plc_controller
        type: plc
        os: embedded
        services: [modbus, dnp3]
        tags: [critical, ics]
        vulnerable: true

      - id: hmi_terminal
        type: hmi
        os: windows_embedded
        services: [wincc]
        tags: [visibility, control]

routes:
  - from: web_server_1
    to: db_server
    via: reverse_proxy
    security: medium
    lateral_possible: true

  - from: ad_server
    to: plc_controller
    via: siem_sensor
    security: high
    monitor: true

  - from: hmi_terminal
    to: plc_controller
    security: low
    monitor: false

defense_systems:
  - id: firewall_main
    type: layer7
    protected_zones: [dmz, internal]
    detection_rules: [sql_injection, port_scan, brute_force]

  - id: ids_core
    type: nids
    position: internal
    ruleset: ["MITRE:T1059", "MITRE:T1071", "MITRE:T1003"]
    alerting: [siem_sensor]

  - id: honeynet
    type: deception
    targets: [ssh, smb, winrm]
    placement: dmz
    node_count: 2

entrypoints:
  - id: phishing_email
    type: social_engineering
    vector: email
    payloads: [malware_loader, beacon]
    targets: [ad_server, db_server]
    success_rate: 0.3

  - id: exposed_port
    type: network
    vector: tcp/22
    node: web_server_1
    success_rate: 0.7
