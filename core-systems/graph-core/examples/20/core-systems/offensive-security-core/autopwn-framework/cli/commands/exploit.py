# autopwn-framework/cli/commands/exploit.py

import asyncio
from autopwn_framework.exploits import ExploitManager
from autopwn_framework.utils.retry import retry_operation

async def exploit_command(target: str, exploit_name: str, options: dict = None):
    """
    Команда для запуска эксплойта на указанную цель с заданным эксплойтом.
    Использует retry-механику для надежности.
    
    :param target: Цель для атаки (например, IP или URL)
    :param exploit_name: Название эксплойта из набора ExploitManager
    :param options: Дополнительные параметры эксплойта (опционально)
    """

    async def run_exploit():
        manager = ExploitManager()
        await manager.load_exploit(exploit_name)
        success = await manager.run_exploit(target, options or {})
        if success:
            print(f"Эксплойт {exploit_name} успешно выполнен на цели {target}")
        else:
            print(f"Эксплойт {exploit_name} не удался на цели {target}")

    await retry_operation(run_exploit, retries=3, delay=5)
