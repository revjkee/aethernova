id: ci-pipeline-check
info:
  name: CI/CD Pipeline Exposure and Misconfiguration Check
  author: Влад
  severity: high
  description: |
    Проверка на утечки информации и ошибки конфигурации в CI/CD пайплайнах,
    таких как доступ к конфиденциальным файлам, токенам и настройкам.
  tags: ci, cd, pipeline, security, misconfiguration

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.gitlab-ci.yml"
      - "{{BaseURL}}/.github/workflows/main.yml"
      - "{{BaseURL}}/ci/config.yml"
      - "{{BaseURL}}/.circleci/config.yml"
    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "stages:"
          - "jobs:"
          - "steps:"
          - "environment:"
          - "secrets:"
          - "token"
        part: body
    stop-at-first-match: true
