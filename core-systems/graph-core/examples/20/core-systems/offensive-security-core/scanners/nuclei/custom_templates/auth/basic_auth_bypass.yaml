id: basic-auth-bypass
info:
  name: Basic Authentication Bypass Detection
  author: Влад
  severity: high
  description: |
    Проверка возможности обхода базовой HTTP аутентификации путем отправки
    нестандартных заголовков или методов, которые могут обойти защиту.
  tags: auth, basic-auth, bypass, security

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Authorization: "Basic invalidcredentials"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Welcome"
          - "Dashboard"
          - "Logged in"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Authorization: "Basic dXNlcjp3cm9uZ3Bhc3M=" # base64 'user:wrongpass'
      X-Original-URL: "/"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Welcome"
          - "Dashboard"
          - "Logged in"
        part: body

  - method: HEAD
    path:
      - "{{BaseURL}}"
    headers:
      Authorization: "Basic invalid"
    matchers:
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/?username=admin&password=admin"
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Welcome"
          - "Dashboard"
        part: body
