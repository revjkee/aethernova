id: teslaai-default-templates
info:
  name: TeslaAI Default Scan Templates
  author: TeslaAI Security Team
  severity: medium
  description: >
    Набор основных шаблонов для обнаружения распространенных уязвимостей с прицелом на безопасность и производительность.

templates:
  - id: http-slowloris
    info:
      name: Slowloris Denial of Service
      author: TeslaAI Security Team
      severity: high
      description: >
        Проверка на уязвимость типа Slowloris DoS, которая замедляет веб-сервер через медленные HTTP-запросы.
    requests:
      - method: GET
        path:
          - "/"
        headers:
          Connection: keep-alive
          Keep-Alive: 1000
        matchers:
          - type: status
            status:
              - 200
          - type: word
            words:
              - "Welcome"
            part: body

  - id: sql-injection-basic
    info:
      name: SQL Injection Basic Test
      author: TeslaAI Security Team
      severity: critical
      description: >
        Тестирование на базовую уязвимость SQL-инъекции через параметры URL.
    requests:
      - method: GET
        path:
          - "/search?q=' OR '1'='1"
        matchers:
          - type: status
            status:
              - 200
          - type: word
            words:
              - "SQL syntax"
              - "mysql_fetch"
              - "You have an error in your SQL syntax"
            part: body

  - id: xss-basic
    info:
      name: Cross-Site Scripting (XSS) Basic Test
      author: TeslaAI Security Team
      severity: high
      description: >
        Проверка на отражённую XSS с использованием базовых payload'ов.
    requests:
      - method: GET
        path:
          - "/search?q=<script>alert('xss')</script>"
        matchers:
          - type: word
            words:
              - "<script>alert('xss')</script>"
            part: body

  - id: open-redirect
    info:
      name: Open Redirect Test
      author: TeslaAI Security Team
      severity: medium
      description: >
        Проверка уязвимости открытого перенаправления.
    requests:
      - method: GET
        path:
          - "/redirect?url=http://evil.com"
        matchers:
          - type: status
            status:
              - 302
          - type: word
            words:
              - "evil.com"
            part: header

  - id: directory-listing
    info:
      name: Directory Listing Detection
      author: TeslaAI Security Team
      severity: low
      description: >
        Проверка включенного листинга директорий.
    requests:
      - method: GET
        path:
          - "/"
        matchers:
          - type: word
            words:
              - "Index of /"
              - "Parent Directory"
            part: body
