apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-config
  namespace: monitoring
data:
  grafana.ini: |
    [server]
    domain = grafana.teslaai.io
    root_url = https://grafana.teslaai.io
    serve_from_sub_path = true

    [auth]
    disable_login_form = true

    [auth.generic_oauth]
    enabled = true
    name = TeslaAI SSO
    allow_sign_up = true
    scopes = openid profile email groups
    role_attribute_path = contains(groups[*], 'teslaai.admin') && 'Admin' || 'Viewer'
