# ueba/config/thresholds.yaml
# Конфигурация чувствительности и реакций UEBA-движка

default:
  min_score: 0.6                # Минимальный риск, считающийся аномалией
  high_score: 0.85              # Сильная аномалия
  low_score: 0.3                # Не учитывать слабые сигналы
  cool_down_sec: 300           # Время блокировки повторных алертов
  alert_on: ["high", "critical"]

risk_levels:
  info:
    score_range: [0.0, 0.3]
    severity: 1
    action: ignore
    tag: weak_signal

  low:
    score_range: [0.3, 0.6]
    severity: 2
    action: log_only
    tag: minor_anomaly

  medium:
    score_range: [0.6, 0.85]
    severity: 3
    action: alert
    tag: suspicious

  high:
    score_range: [0.85, 0.95]
    severity: 4
    action: alert_and_trace
    tag: strong_anomaly

  critical:
    score_range: [0.95, 1.0]
    severity: 5
    action: alert_and_block
    tag: immediate_threat

entity_types:
  user:
    default_threshold: 0.6
    lock_threshold: 0.95
    action_on_high: escalate_to_admin

  service:
    default_threshold: 0.7
    lock_threshold: 0.9
    action_on_high: notify_devsecops

  llm_agent:
    default_threshold: 0.75
    lock_threshold: 0.92
    action_on_high: trace_command_graph

reactions:
  alert:
    method: internal_event_bus
    send_to: ["grafana", "prometheus", "siem"]

  block:
    method: orchestrator
    trigger: "lock_session"

  trace:
    method: telemetry
    enable: true
    trace_window_sec: 120

metadata:
  version: "2.0"
  description: >
    Расширенная конфигурация для реактивной модели UEBA.
    Поддерживает профили per-entity и динамическую настройку алертов.
  updated_at: "2025-07-25T14:00:00Z"
