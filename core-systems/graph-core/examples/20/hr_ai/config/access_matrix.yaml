version: 3.1-enterprise
description: |
  Полная матрица доступа HR-AI, соответствующая Zero Trust, RBAC/ABAC,
  с многоуровневой логикой, контекстной проверкой и трассируемостью.

global_policies:
  - name: zero_trust_enforced
    enabled: true
  - name: audit_logging
    level: full
  - name: real_time_violation_alerts
    notify: security@neurocity.internal
  - name: anomaly_detection
    engine: audit.anomaly_guard
  - name: ethics_gate
    module: comms.ethics_filter

roles:
  - name: admin
    privileges:
      - full_pipeline_control
      - modify_policy
      - decrypt_logs
      - emergency_override
    context_constraints:
      - location: internal
      - device_certified: true

  - name: hr_reviewer
    privileges:
      - view_structured_cv
      - approve_candidates
      - comment_explanations
    context_constraints:
      - access_time: "08:00-19:00"
      - mfa_required: true

  - name: ai_agent
    privileges:
      - read_module_output
      - write_module_output
      - trigger_next_stage
    dynamic_rules:
      - if: prediction.confidence < 0.6
        then: escalate_to_human
      - if: profile.ethical_risk > 0.2
        then: block_and_log

  - name: ethics_auditor
    privileges:
      - access_ethics_report
      - block_pipeline_stage
    context_constraints:
      - isolated_env: true

  - name: external_auditor
    privileges:
      - read_only_access
      - view_audit_log
      - export_summary
    context_constraints:
      - vpn_required: true
      - gpg_signature_required: true

modules:
  intake.cv_parser:
    access:
      - agent: ai_agent
      - role: admin

  intake.skill_matcher:
    access:
      - agent: ai_agent
      - role: hr_reviewer

  prediction.performance_model:
    access:
      - agent: ai_agent
      - role: ethics_auditor

  dashboard.dashboard:
    access:
      - role: hr_reviewer
      - role: external_auditor

  audit.anomaly_guard:
    access:
      - role: admin
      - role: ethics_auditor

  governance.policy_rules:
    access:
      - role: admin
      - role: ethics_auditor

object_level_policies:
  - object: logs.db
    read: [admin, external_auditor]
    write: [admin]
    encrypt: true

  - object: candidate_profile
    read: [hr_reviewer, ai_agent]
    redact_fields:
      - personal_email
      - phone_number

  - object: explanation_trace
    read: [ethics_auditor, hr_reviewer]
    write: [xai_agent]
    audit: full

meta:
  signature: GPG-SIG-NEUROCITY-TRUSTED
  last_updated: 2025-08-05T13:00:00Z
  maintained_by: governance-core
  change_request_url: https://audit.neurocity/hr/access/update
