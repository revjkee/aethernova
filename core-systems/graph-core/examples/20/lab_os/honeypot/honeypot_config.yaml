# Конфигурация Honeypot системы Lab OS

honeypot:
  enabled: true
  type: ssh
  listen_address: 0.0.0.0
  listen_port: 2222
  max_connections: 100
  timeout_seconds: 300
  log_level: info
  capture_payload: true
  alerting:
    enabled: true
    method: webhook
    webhook_url: "https://security-monitoring.lab/api/honeypot_alerts"
  sandbox:
    enabled: true
    isolation_level: high
    command_restrictions:
      - "ls"
      - "whoami"
      - "pwd"
      - "id"
    file_write_disabled: true
  credentials:
    users:
      - username: admin
        password_hash: "$6$randomsalt$hashedpasswordhere"
      - username: guest
        password_hash: "$6$randomsalt$guestpasswordhash"
  deception:
    fake_files:
      - path: /etc/passwd
        content: |
          root:x:0:0:root:/root:/bin/bash
          daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
          fakeuser:x:1001:1001:Fake User:/home/fakeuser:/bin/bash
      - path: /var/log/auth.log
        content: |
          Jul 14 00:00:00 honeypot sshd[1234]: Failed password for invalid user root from 192.168.1.100 port 22 ssh2
  reporting:
    enabled: true
    report_interval_minutes: 60
    report_destination: "security-team@lab.local"
  integrations:
    siem:
      enabled: true
      endpoint: "https://siem.lab/api/events"
      api_key: "your_siem_api_key_here"
  updates:
    auto_update: true
    update_check_interval_hours: 24
    update_source: "https://lab-os-updates.lab/releases/honeypot"

metrics:
  enabled: true
  collect_frequency_seconds: 60
  storage_backend: prometheus
  prometheus:
    pushgateway_url: "http://prometheus.lab:9091"

notes:
  - Honeypot запускается в изолированной среде с ограниченным набором команд.
  - Все активности логируются и отправляются в SIEM и систему оповещений.
  - Фейковые файлы для увеличения реалистичности.
  - Автоматическое обновление безопасности и функционала.
