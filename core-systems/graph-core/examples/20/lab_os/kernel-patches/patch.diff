--- a/net/core/dev.c
+++ b/net/core/dev.c
@@ -1234,7 +1234,14 @@ static int net_dev_open(struct net_device *dev)
-    err = netif_start_queue(dev);
-    if (err) {
-        pr_err("Failed to start queue on device %s\n", dev->name);
-        return err;
-    }
+    /* Улучшенная проверка и запуск очереди */
+    if (!netif_queue_stopped(dev)) {
+        pr_warn("Queue on device %s is already started\n", dev->name);
+    } else {
+        err = netif_start_queue(dev);
+        if (err) {
+            pr_err("Failed to start queue on device %s\n", dev->name);
+            return err;
+        }
+    }

@@ -2345,6 +2352,15 @@ int __netif_receive_skb_core(struct sk_buff *skb)
-    /* Проверка длины пакета */
-    if (skb->len > dev->mtu) {
-        kfree_skb(skb);
-        return NET_RX_DROP;
-    }
+    /* Улучшенная проверка длины пакета с логированием */
+    if (skb->len > dev->mtu) {
+        pr_warn("Packet length %u exceeds MTU %u on device %s, dropping\n",
+            skb->len, dev->mtu, dev->name);
+        kfree_skb(skb);
+        return NET_RX_DROP;
+    }
