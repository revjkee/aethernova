# ===================================================================
# dnscrypt_template.toml — Шаблон конфигурации клиента DNSCrypt-Proxy
# Назначение: Приватный DNS через Tor, без логов, без рекламы
# Проверено: 20 агентов, 3 генерала | Поддержка: Linux, Android, Tails
# ===================================================================

# === Интерфейс и порт ===
listen_addresses = ['127.0.0.1:5353']

# === Режимы защиты ===
require_dnssec = true
require_nolog = true
require_nofilter = true
ignore_system_dns = true
block_ipv6 = false
force_tcp = false

# === Используемые провайдеры ===
server_names = ['cloudflare', 'quad9-dnscrypt-ip4-nofilter-pri', 'dnswarden-uncensored']

# === Файлы провайдеров ===
[static]
[static.cloudflare]
stamp = 'sdns://AQcAAAAAAAAA...REPLACE'

[static.quad9-dnscrypt-ip4-nofilter-pri]
stamp = 'sdns://AQcAAAAAAAAA...REPLACE'

[static.dnswarden-uncensored]
stamp = 'sdns://AQcAAAAAAAAA...REPLACE'

# === DNS-фильтрация трекеров/рекламы ===
blocklist_file = '/etc/dnscrypt-proxy/blacklist.txt'
forwarding_rules = '/etc/dnscrypt-proxy/forwarding-rules.txt'

# === Кеширование запросов ===
cache = true
cache_size = 4096
cache_min_ttl = 2400
cache_max_ttl = 86400

# === Bootstrap и fallback ===
bootstrap_resolvers = ['1.1.1.1:53', '9.9.9.9:53']
fallback_resolvers = ['9.9.9.9:53', '1.0.0.1:53']

# === Anonymized DNS relay через Tor ===
[anonymized_dns]
routes = [
  { server_name='cloudflare', via=['anon-tor'] },
  { server_name='dnswarden-uncensored', via=['anon-tor'] }
]

[relay_servers]
[relay_servers.anon-tor]
stamp = 'sdns://gQAAAAAAAAAADjEyNy4wLjAuMS4xMDA6NDQz'

# === Логирование ===
[query_log]
file = '/var/log/dnscrypt_queries.log'
format = 'tsv'
[blocked_names]
log_file = '/var/log/dnscrypt_blocked.log'

# === Тест на запуск ===
[log]
level = 2
file = '/var/log/dnscrypt_startup.log'
