# aethernova-chain-core/ops/terraform/modules/policies/kyverno/policies/test/cases/require-default-deny-networkpolicy/test.yaml
apiVersion: cli.kyverno.io/v1alpha1
kind: Test
metadata:
  name: require-default-deny-networkpolicy

# Политика Kyverno, генерирующая default-deny NetworkPolicy в новых Namespace.
# Путь укажите на ваш фактический файл политики с правилом 'default-deny'.
policies:
  - ../../clusterpolicies/best-practices/add-networkpolicy.yaml

# Тестовые ресурсы: Namespace, для которого должна быть сгенерирована NetworkPolicy.
resources:
  - resources/namespaces/dev-a.yaml

# Ожидаемый результат:
#  - Политика 'add-networkpolicy' с правилом 'default-deny' должна PASS и
#    сгенерировать ресурс, соответствующий expected/dev-a-default-deny.yaml.
results:
  - policy: add-networkpolicy
    rule: default-deny
    resources:
      - dev-a
    kind: Namespace
    result: pass
    generatedResource: expected/dev-a-default-deny.yaml
