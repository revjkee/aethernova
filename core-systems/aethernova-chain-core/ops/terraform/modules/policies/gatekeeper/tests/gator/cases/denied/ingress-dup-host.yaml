# File: aethernova-chain-core/ops/terraform/modules/policies/gatekeeper/tests/gator/cases/denied/ingress-dup-host.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: dup-host-under-test
  namespace: policy-tests
  labels:
    app.kubernetes.io/name: dup-host-under-test
    app.kubernetes.io/part-of: aethernova-chain-core
    gatekeeper.sh/test-scope: gator
  annotations:
    # Это лишь метаданные для удобства аудита тестов.
    policies.aethernova.io/test-purpose: "Ingress with duplicate host to trigger K8sUniqueIngressHost constraint"
spec:
  ingressClassName: nginx
  rules:
    - host: app.example.internal            # Должен совпадать с host из inventory в Suite, чтобы кейс был 'denied'
      http:
        paths:
          - path: /
            pathType: Prefix
            backend:
              service:
                name: web-backend
                port:
                  number: 80
