// aethernova-chain-core/ops/terraform/modules/compute/ingress-lb/versions.tf
// Промышленная фиксация версий Terraform и провайдеров для модуля ingress-lb.
//
// Основано на официальных рекомендациях по:
// - terraform { required_providers }: объявление источников провайдеров и их версий
// - required_version: ограничение версии Terraform
// - Версионирование с использованием «пессимистичного» оператора ~> и верхних границ мажорных версий
// - Исключение устаревшего аргумента provider.version (фиксируем версии только в required_providers)
//
// См. источники в сопровождающем ответе.

terraform {
  // Требуемая версия Terraform. Верхняя граница < 2.0.0 для безопасного будущего мажорного релиза.
  required_version = ">= 1.6.0, < 2.0.0"

  // Фиксация источников и допустимых версий провайдеров.
  // Примечание: Terraform скачает точные версии согласно .terraform.lock.hcl на уровне root-модуля.
  required_providers {
    // Для балансировщиков в AWS (ALB/NLB).
    aws = {
      source  = "hashicorp/aws"
      // Разрешаем минорные/патч-обновления в рамках мажора 5: >=5.0,<6.0
      // Можно сузить до ~> 5.60 (пример), но это делается на уровне продукта после валидации.
      version = ">= 5.0.0, < 6.0.0"
    }

    // Если модуль взаимодействует с кластером (например, аннотации для Ingress Controller через API k8s):
    // Оставьте блок, если используете ресурсы/данные из провайдера kubernetes; иначе удалите.
    kubernetes = {
      source  = "hashicorp/kubernetes"
      version = ">= 2.20.0, < 3.0.0"
    }

    // Для Helm-релизов (например, AWS Load Balancer Controller).
    // Аналогично: оставьте, если модуль действительно использует helm_release; иначе удалите.
    helm = {
      source  = "hashicorp/helm"
      version = ">= 2.9.0, < 3.0.0"
    }

    // Вспомогательные провайдеры — подключайте только при фактическом использовании в модуле:
    // random = {
    //   source  = "hashicorp/random"
    //   version = ">= 3.5.0, < 4.0.0"
    // }
    //
    // tls = {
    //   source  = "hashicorp/tls"
    //   version = ">= 4.0.0, < 5.0.0"
    // }
  }
}

// ВАЖНО:
// 1) Точные версии провайдеров фиксируются в корневом .terraform.lock.hcl (root-модуль).
// 2) Не указывайте "version" внутри provider-блоков: аргумент устарел — используйте только required_providers.
// 3) При изменении ограничений запустите `terraform init -upgrade` в корне, чтобы обновить lock-файл.
