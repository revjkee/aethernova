# neuroforge-core / mypy.ini
# Базовая строгая конфигурация для промышленного репозитория.
# Unverified: значения вроде python_version и имена модулей уточняйте под свой проект.

[mypy]
python_version = 3.11
platform = linux

# Что проверяем по умолчанию (главный пакет и тесты)
files = neuroforge_core, tests

# Пути к локальным stub-пакетам (если есть)
mypy_path = stubs

# Производительность и кэш
incremental = True
sqlite_cache = True
cache_dir = .mypy_cache

# Пакеты репозитория (PEP 420 / src-layout)
namespace_packages = True
explicit_package_bases = True

# Импортная политика
follow_imports = normal
no_implicit_reexport = True

# Диагностика
show_error_codes = True
show_column_numbers = True
pretty = True
color_output = True
error_summary = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_return_any = True
warn_unreachable = True
warn_unused_configs = True

# Строгость
allow_redefinition = False
allow_untyped_globals = False
disallow_any_unimported = True
disallow_any_generics = True
disallow_subclassing_any = True
disallow_untyped_calls = True
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
local_partial_types = True

# Исключения путей (build артефакты, миграции, автоген)
exclude = (?x)(
    ^build/|
    ^dist/|
    ^\.venv/|
    ^\.?mypy_cache/|
    ^\.tox/|
    ^\.pytest_cache/|
    ^.*?/migrations/|
    ^.*?/_generated/|
    ^scripts/experimental/
)

# ----------------------------------------------------------
# Персональные профили для отдельных зон кода
# ----------------------------------------------------------

# Основной пакет — держим строгий baseline (можно расширять при необходимости)
[mypy-neuroforge_core.*]

# Тесты: послабления, чтобы не блокировать TDD и fuzz
[mypy-tests.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
warn_return_any = False
allow_redefinition = True
ignore_missing_imports = True

# Fuzz-тесты часто используют динамику и сторонние ген-утилиты
[mypy-tests.fuzz.*]
disallow_any_generics = False
warn_unreachable = False
warn_unused_ignores = False

# Миграции/генерация — не блокируем сборку типами
[mypy-*.migrations.*]
ignore_errors = True

# Сценарии сборки/скрипты, если есть
[mypy-scripts.*]
disallow_untyped_defs = False
disallow_untyped_calls = False
warn_return_any = False

# ----------------------------------------------------------
# Внешние библиотеки без типингов (шаблоны — раскомментируйте при необходимости)
# ----------------------------------------------------------
# [mypy-numpy.*]
# ignore_missing_imports = True
# [mypy-pandas.*]
# ignore_missing_imports = True
# [mypy-sklearn.*]
# ignore_missing_imports = True
# [mypy-torch.*]
# ignore_missing_imports = True
# [mypy-tensorflow.*]
# ignore_missing_imports = True
# [mypy-opencv.*]
# ignore_missing_imports = True
# [mypy-matplotlib.*]
# ignore_missing_imports = True
# [mypy-hypothesis.*]
# ignore_missing_imports = True

# ----------------------------------------------------------
# Плагины (включайте только если установлены; иначе mypy упадёт на импорте)
# ----------------------------------------------------------
# plugins = pydantic.mypy, attrs
#
# [pydantic-mypy]
# init_typed = True
# warn_required_dynamic_aliases = True
#
# (для SQLAlchemy при наличии stubs/плагина)
# plugins = sqlalchemy.ext.mypy.plugin
