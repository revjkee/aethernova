# =============================================================================
# zero-trust-core â€” Kubernetes PodDisruptionBudget (base)
# Path: zero-trust-core/ops/k8s/base/pdb.yaml
# Profile binding label: pdb.aethernova.io/profile = { stateless | stateful | singleton | ingress }
# =============================================================================

apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: zt-pdb-stateless
  labels:
    app.kubernetes.io/part-of: zero-trust-core
    app.kubernetes.io/component: pdb
    zero-trust-core.io/profile: stateless
  annotations:
    kubernetes.io/description: "Stateless workloads: allow up to 25% voluntary disruptions."
spec:
  maxUnavailable: "25%"
  selector:
    matchLabels:
      pdb.aethernova.io/profile: stateless

---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: zt-pdb-stateful
  labels:
    app.kubernetes.io/part-of: zero-trust-core
    app.kubernetes.io/component: pdb
    zero-trust-core.io/profile: stateful
  annotations:
    kubernetes.io/description: "Stateful workloads: keep at least 66% available."
spec:
  minAvailable: "66%"
  selector:
    matchLabels:
      pdb.aethernova.io/profile: stateful

---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: zt-pdb-singleton
  labels:
    app.kubernetes.io/part-of: zero-trust-core
    app.kubernetes.io/component: pdb
    zero-trust-core.io/profile: singleton
  annotations:
    kubernetes.io/description: "Singleton/critical services: disallow voluntary evictions."
spec:
  minAvailable: 1
  selector:
    matchLabels:
      pdb.aethernova.io/profile: singleton

---
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: zt-pdb-ingress
  labels:
    app.kubernetes.io/part-of: zero-trust-core
    app.kubernetes.io/component: pdb
    zero-trust-core.io/profile: ingress
  annotations:
    kubernetes.io/description: "Ingress/edge: maintain at least 2 pods for continuous traffic handling."
spec:
  minAvailable: 2
  selector:
    matchLabels:
      pdb.aethernova.io/profile: ingress
