# TeslaAI Genesis Immutable Rule Lock — Hardening Policies v7
# Проверено: 20 AI-агентов, одобрено 3 метагенералами

meta:
  policy_set: "ai_governance_hardening"
  version: "2.0-industrial"
  created_by: "TeslaAI Genesis Security Council"
  last_updated: "2025-07-28T00:00:00Z"
  signature_required: true
  enforce_integrity: true

rules:
  - id: "rule_freeze_on_violation"
    description: "Автоматическая блокировка правила при обнаружении критического нарушения безопасности"
    enforcement: hard
    trigger:
      type: anomaly
      condition: "score > 0.85"
    actions:
      - type: freeze_rule
      - type: notify
        target: "admin,security_lead"
      - type: log_event
        severity: critical
        category: immutable_violation

  - id: "rule_hash_mismatch_detection"
    description: "Запрет выполнения правила, если нарушена контрольная сумма"
    enforcement: strict
    trigger:
      type: integrity
      condition: "hash_mismatch == true"
    actions:
      - type: block_execution
      - type: alert
        channel: "security_feed"
      - type: quarantine
        level: "rule_only"

  - id: "rule_change_requires_rbac_signatures"
    description: "Обновления правил требуют цифровых подписей от 2 RBAC-валидаторов и 1 офицера безопасности"
    enforcement: enforced
    trigger:
      type: update_attempt
    conditions:
      min_signatures: 3
      roles_required:
        - rbac_validator
        - security_officer
    actions:
      - type: allow_if_signed
      - type: reject_and_alert_if_missing

  - id: "no_exec_outside_immutable_zone"
    description: "Запрет исполнения правил за пределами доверенной зоны исполнения"
    enforcement: mandatory
    trigger:
      type: execution_context
      condition: "env not in ['immutable-vm', 'sandboxed-node']"
    actions:
      - type: terminate_execution
      - type: escalate_to_jailkeeper
      - type: log_event
        severity: high
        category: policy_breach

  - id: "rule_expiry_enforced"
    description: "Истекающие правила автоматически помечаются как deprecated и выносятся на пересмотр"
    enforcement: procedural
    trigger:
      type: time
      condition: "rule_expiry < now + 7d"
    actions:
      - type: notify
        target: "policy_reviewer"
      - type: mark_as_deprecated
      - type: block_future_execution

defaults:
  encryption: gpg
  sandbox_enforced: true
  rollback_allowed: false
  auto_audit: true
  max_rule_lifetime_days: 180
  metadata_required_fields:
    - id
    - description
    - enforcement
    - trigger
    - actions
