version: "1.0.0"
generated_at: "2025-08-22T00:00:00Z"

metadata:
  component: "physical-integration-core"
  file: "configs/safety.yaml"
  owner:
    org: "NeuroCity"
    team: "Platform-Security-Core"
    contact: "safety@neurocity.local"
  scope:
    description: >
      Enterprise safety governance for integration of robots, PLCs, AGVs,
      motion systems, process equipment, sensors, power, and supporting OT-IT stack.
    facilities:
      - main_factory
      - lab_a
      - pilot_site
    lifecycle:
      - design
      - build
      - commission
      - operate
      - maintain
      - decommission

governance:
  policies:
    zero_trust_safety: true
    safety_over_availability: true
    defense_in_depth: true
    least_privilege_ot: true
  management_roles:
    - name: "Site Safety Officer"
      responsibility: "Overall responsibility for site safety and permits"
    - name: "Process Safety Engineer"
      responsibility: "Risk analysis, SIF and proof-test planning"
    - name: "OT Security Lead"
      responsibility: "Zones, conduits, firewalls, allowlists"
    - name: "Maintenance Supervisor"
      responsibility: "LOTO, preventive maintenance, calibrations"
    - name: "Commissioning Manager"
      responsibility: "SAT, FAT, iFAT, acceptance and sign off"
  change_management:
    moc_required: true
    approval_chain:
      - Site Safety Officer
      - Process Safety Engineer
      - OT Security Lead
    records:
      system: "cmdb"
      retention_days: 3650

standards_and_codes:
  references:
    functional_safety:
      - IEC_61508
      - IEC_62061
      - ISO_13849_1
    machinery_safety:
      - ISO_12100
      - ISO_13850
      - ISO_10218
      - ISO_3691_4
    process_safety:
      - IEC_61511
      - ISO_31000
      - API_RP_754
    electrical_and_lockout:
      - NFPA_70
      - NFPA_70E
      - OSHA_1910_147
    cyber_security_ot:
      - IEC_62443_series
      - NIST_SP_800_82
    other:
      - ISO_45001
      - ISO_14644
  compliance:
    mandatory: true
    deviation_process: "risk_based_with_senior_approval"
    evidence_required: true

risk_management:
  methods:
    - HAZOP
    - FMEA
    - FTA
    - LOPA
  risk_matrix:
    likelihood_levels: [Rare, Unlikely, Possible, Likely, Almost_Certain]
    severity_levels: [Minor, Serious, Major, Critical, Catastrophic]
    acceptability:
      alarp: true
      intolerable_threshold: "High"
      tolerable_if_alarp: "Medium"
      broadly_acceptable: "Low"
  reporting:
    kpis:
      - name: "TRIR"
        target: "< 0.5"
      - name: "Near_Miss_Rate_per_100k_hours"
        target: "< 3.0"
      - name: "SIF_Demand_Rate"
        target: "<= design_assumption"
      - name: "Proof_Test_On_Time"
        target: ">= 98 percent"
    cadence:
      - weekly
      - monthly
      - quarterly

hazard_catalog:
  categories:
    mechanical: ["crush", "shear", "entanglement", "impact", "pinch"]
    electrical: ["shock", "arc_flash", "arc_blast"]
    thermal: ["burn", "fire", "hot_surface"]
    chemical: ["toxic_release", "corrosive", "flammable"]
    ergonomic: ["overexertion", "repetitive"]
    radiation: ["uv", "laser_class_3r_plus"]
    environment: ["noise", "dust", "emissions"]
  top_events_examples:
    - id: "TE-001"
      title: "Unexpected robot motion"
      consequences: ["injury", "equipment_damage"]
      initiating_causes: ["control_fault", "sensor_failure", "network_spoof"]
    - id: "TE-002"
      title: "Loss of containment"
      consequences: ["fire", "toxic_exposure", "environmental_harm"]

sif_and_sil:
  methodology: "IEC_61511_LOPA"
  sifs:
    - tag: "SIF-EMO-001"
      function: "Emergency stop for robot cell A"
      demand_rate_per_year: 0.1
      sil_target: 2
      architecture: "1oo2 safety relays with safety PLC validation"
      proof_test_interval_days: 365
      proof_test_coverage: ">= 90 percent"
      diagnostics: "online_test_each_startup"
      bypass_policy: "forbidden_in_operation"
    - tag: "SIF-GAS-LEL"
      function: "Shutoff fuel gas on LEL detection"
      demand_rate_per_year: 0.2
      sil_target: 3
      architecture: "2oo3 gas detectors, 1oo2 valve solenoids"
      proof_test_interval_days: 180
      bypass_policy: "permitted_only_with_permit_and_monitoring"
  common_cause:
    beta_factor: 0.05
    separation_required: true

controls_hierarchy:
  order: ["elimination", "substitution", "engineering", "administrative", "PPE"]
  engineering_controls:
    physical_guards: true
    interlocked_doors:
      monitored: true
      type: "cat4_pl_e_or_sil2_plus"
    light_curtains:
      resolution_mm: 14
      muting_controlled: true
    safety_mats: true
    two_hand_controls_where_applicable: true
    speed_and_separation_monitoring:
      standard: "ISO_10218_SSM"
      safe_camera_or_lidar: true
    safe_torque_off:
      required_for_drives: true
      monitored: true
    e_stop:
      color: "red_yellow_background"
      latching: true
      category: "ISO_13850"
      spacing_meters_max: 6
      reset_local_only: true
  administrative_controls:
    sop_required: true
    permit_to_work:
      hot_work: true
      confined_space: true
      energized_work: true
      work_at_height: true
    loto:
      procedure_version: "v3.2"
      mandatory_for_energized_equipment: true
      locks_color_code: "red_personal_yellow_group"
      verification_step: "try_start_test"
    training:
      induction: true
      annual_refresh: true
      role_based:
        - operator
        - maintenance
        - integrator
        - contractor
  ppe:
    base:
      - safety_shoes
      - hi_vis
      - safety_glasses
    task_specific:
      - face_shield
      - cut_resistant_gloves
      - arc_flash_suit
      - respirator

ot_cybersecurity:
  zoning:
    zones:
      - name: "Level_0_Sensors_Actuators"
        connectivity: "hard_isolation"
      - name: "Level_1_Basic_Control_PLC"
        firewall: "strict_allowlist"
      - name: "Level_2_Supervisory_HMI"
        firewall: "stateful_with_ips"
      - name: "Level_3_Site_Operations"
        firewall: "segmented_with_idps"
      - name: "Level_3_5_DMZ"
        firewall: "data_diodes_or_proxy"
      - name: "Level_4_IT"
        firewall: "enterprise"
  comms:
    allowed_protocols:
      - "Modbus-TCP"
      - "EtherNet-IP"
      - "Profinet"
      - "OPC-UA"
    tls_for_opcua: "required"
    signing_and_integrity: "required_for_config_and_firmware"
    time_sync: "PTP_or_NTP_locked"
  identity_access:
    mfa_for_engineering_workstations: true
    unique_accounts_no_shared: true
    just_in_time_access: true
    password_policy:
      min_length: 16
      rotation_days: 90
      device_bound_credentials: true
  monitoring:
    syslog_to_siemplatform: true
    passive_network_sensor: true
    anomaly_detection: true
  patching:
    firmware_signing_required: true
    test_in_staging_before_prod: true
    emergency_patch_window_hours: 72

s_plc_and_safety_relays:
  approved_platforms:
    - "S7-1500F"
    - "GuardLogix"
    - "Pilz_PNOZmulti"
  programming_rules:
    certified_function_blocks_only: true
    no_forced_bits_in_prod: true
    heartbeat_watchdog_required: true
    diversity_check_for_redundant_paths: true
  diagnostics:
    fault_latching: true
    powerup_self_test: true
    periodic_self_test_hours: 24

robotics_and_motion:
  modes:
    manual_setup: "reduced_speed_hold_to_run"
    teach_mode: "enforced_with_key"
    automatic: "guarded_with_all_interlocks_ok"
  collaborative:
    p_fl_limits:
      force_newton_max: 140
      pressure_kpa_max: 100
    ssm_parameters:
      min_separation_mm: 850
      response_time_ms_max: 150
  agv_aml:
    speed_limits_mps:
      normal: 1.2
      near_pedestrian: 0.4
    priority_rules: "pedestrian_priority"
    zone_control: "safety_lidar_required"

power_and_energy_isolation:
  sources:
    - electrical
    - pneumatic
    - hydraulic
    - mechanical_stored
    - thermal
    - chemical
  emergency_power_off:
    mushroom_buttons_present: true
    affects: ["drives", "field_power"]
    excludes: ["safety_plc", "network_core_if_required"]
  ups:
    critical_nodes:
      - safety_plc
      - hmi
      - historian
    autonomy_minutes: 15

detection_and_suppression:
  fire:
    detection: ["smoke", "heat"]
    suppression: ["clean_agent", "sprinkler_where_applicable"]
    separation_fire_rating_minutes: 60
  gas:
    lel_sensors: true
    toxic_sensors: ["H2S", "CO"]
    calibration_interval_days: 90
  environment:
    noise_monitoring: true
    dust_collectors_interlocked: true

permits_and_procedures:
  permit_to_work_system: "digital"
  approvals_required:
    hot_work: ["Site Safety Officer", "Fire Marshal"]
    confined_space: ["SSO", "Rescue Team"]
    energized_work: ["Electrical Authority"]
  job_safety_analysis_required: true
  pre_job_brief_required: true
  shift_handover_log_required: true

testing_and_validation:
  strategy:
    - FAT
    - iFAT
    - SAT
    - commissioning
  acceptance_criteria:
    e_stop_response_time_ms_max: 200
    guard_open_stop_category: "stop_category_0_or_1_as_designed"
    ssm_end_to_end_latency_ms_max: 150
    proof_of_interlocks: "100 percent scenarios"
  test_artifacts:
    video_evidence_required: true
    signed_reports_required: true
    traceability_matrix: true
  periodic_tests:
    e_stop_functional_test_days: 30
    interlock_test_days: 90
    sif_proof_test_as_configured: true

maintenance_and_calibration:
  pm_plan_source: "cmms"
  instrument_calibration:
    interval_days_default: 180
    as_found_as_left_recording: true
    out_of_tolerance_investigation: true
  spares:
    critical_spares_min_coverage_days: 30
    dual_vendor_strategy_where_possible: true

training_and_competence:
  matrix:
    operator:
      induction_hours: 8
      annual_refresh_hours: 4
    maintainer:
      induction_hours: 16
      annual_refresh_hours: 8
      electrical_authorization_required: true
    integrator:
      functionalsafety_cert_required: true
  drills:
    e_stop_and_evacuations_quarterly: true
    gas_release_drill_semiannual: true

incident_management:
  detection_channels:
    - andon
    - hmi_alarm
    - siem_alert
    - near_miss_report
  severity_scale: [S0_Info, S1_Low, S2_Medium, S3_High, S4_Critical]
  response:
    s3_and_above_require_shutdown_decision: true
    5_whys_required: true
    containment_within_minutes: 30
  reporting:
    regulator_notification_threshold: "S3_or_above"
    union_rep_notification_if_applicable: true
  learning:
    corrective_actions_deadline_days: 30
    effectiveness_review_days: 60

monitoring_and_alerts:
  alarm_severity_mapping:
    critical:
      notify: ["SSO", "OT_Security_Lead", "Shift_Manager"]
      channel: ["sms", "voice_call", "hmi"]
      ack_timeout_minutes: 2
    high:
      notify: ["Shift_Manager"]
      channel: ["hmi", "email"]
      ack_timeout_minutes: 5
    medium:
      notify: ["Area_Supervisor"]
      channel: ["hmi"]
      ack_timeout_minutes: 10
    low:
      notify: ["Operator"]
      channel: ["hmi"]
      ack_timeout_minutes: 30
  shelving_policy:
    max_shelve_minutes: 60
    justification_required: true
    auto_unshelve_on_shift_change: true

documentation_and_audit:
  records:
    retention_years: 10
    immutability: true
    signer_identity_required: true
  audits:
    internal_quarterly: true
    external_annual: true
    surprise_inspections_per_year: 2
  digital_twin_linked: true
  config_signature:
    algorithm: "ed25519"
    required_for_deploy: true

deviation_and_waivers:
  allowed: false
  emergency_waiver_process:
    max_duration_hours: 24
    monitoring_required: true
    risk_owner_accountable: true

continuous_improvement:
  source_inputs:
    - incident_root_cause
    - near_miss_trends
    - audit_findings
    - technology_updates
  cadence: "quarterly_review_board"
  budget_reserved_percent_opex: 1.0
