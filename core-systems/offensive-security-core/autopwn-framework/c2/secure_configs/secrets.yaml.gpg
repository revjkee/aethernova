# === Операторские токены и роли ===
operators:
  - name: "genesis-root"
    token: "ENV::GENESIS_ROOT_TOKEN"
    rbac: "admin"
    mfa_required: true

  - name: "c2-controller"
    token: "ENV::C2_CONTROL_TOKEN"
    rbac: "operator"
    mfa_required: true

  - name: "observer-node"
    token: "ENV::OBSERVER_READONLY_TOKEN"
    rbac: "readonly"
    mfa_required: false

# === API-ключи внешних сервисов ===
external_services:
  slack:
    webhook_url: "ENV::SLACK_ALERT_WEBHOOK"
  sentry:
    dsn: "ENV::SENTRY_DSN"
  elasticsearch:
    uri: "https://es.teslaai.local"
    token: "ENV::ES_TOKEN"

# === Ключи подписей и шифрования ===
crypto_keys:
  gpg:
    operator_key: "/etc/c2keys/operator_sec.key"
    public_key: "/etc/c2keys/operator_pub.key"
  jwt:
    secret: "ENV::JWT_SIGN_SECRET"
    expiration_minutes: 360

# === Привязка к хосту (аппаратная идентификация) ===
hardware_binding:
  device_id: "tesla-genesis-main"
  fingerprint_sha256: "d8b8d4f3c01977a35a177fcb5c7d70c2ff1174c5f80c213127e6e66a7b7db6ce"

# === Серверные пароли и доступы (зашифровано на уровне ENV) ===
ssh_keys:
  main_admin: "ENV::SSH_KEY_MAIN"
  backup_operator: "ENV::SSH_KEY_BACKUP"

# === Секреты автообновлений и резервных систем ===
autoupdate:
  repo_token: "ENV::GIT_REPO_AUTHTOKEN"
  update_channel: "stable"
  fail_safe_revert: true

# === Контроль доступа на стороне C2 (для автогенерации ACL) ===
access_control:
  max_ops_per_operator: 3
  session_timeout_sec: 900
  enforce_time_restrictions: true
  allowed_hours_utc:
    start: "06:00"
    end: "22:00"
