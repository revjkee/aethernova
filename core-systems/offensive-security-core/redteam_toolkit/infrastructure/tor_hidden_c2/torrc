# redteam_toolkit/infrastructure/tor_hidden_c2/torrc

## Общие настройки безопасности
RunAsDaemon 1
User debian-tor
Log notice file /var/log/tor/notices.log

## Ограничения сети
ClientOnly 0
SocksPort 9050
SocksPolicy accept 127.0.0.1

## Скрытый сервис (C2)
HiddenServiceDir /var/lib/tor/hidden_service_c2/
HiddenServiceVersion 3
HiddenServicePort 443 127.0.0.1:8443
HiddenServicePort 80 127.0.0.1:8080

## Защита от fingerprinting и deanonymization
AvoidDiskWrites 1
DisableDebuggerAttachment 0
MaxCircuitDirtiness 600
CircuitBuildTimeout 15
LearnCircuitBuildTimeout 0
UseEntryGuards 1
SafeLogging 1

## Ограничение на выход из Tor
ExitRelay 0
ExitPolicy reject *:*

## Включение мостов и обфускация
ClientTransportPlugin obfs4 exec /usr/bin/obfs4proxy
Bridge obfs4 178.62.0.1:9001 8F742ADC46D5A9C15AB1B2A247F52F122504BF53 cert=Iv6...iUA iat-mode=0
Bridge obfs4 185.220.101.1:443 7E23F020ABCE559B1FBC4D103A4FDEF81A230E3B cert=gzO...PvQ iat-mode=1
UseBridges 1

## Установка выходного интерфейса и DNS
VirtualAddrNetworkIPv4 10.192.0.0/10
AutomapHostsOnResolve 1
DNSPort 5353
AutomapHostsSuffixes .onion,.exit

## Дополнительно для стабильности
KeepalivePeriod 60
NumCPUs 2
ConnLimit 1024
AvoidDiskWrites 1

## Статус и контроль
ControlPort 9051
HashedControlPassword 16:2A5D66A2AA...D21A
CookieAuthentication 1
