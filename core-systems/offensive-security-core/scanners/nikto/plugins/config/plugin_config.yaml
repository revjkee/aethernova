version: 2.0-industrial
description: >
  Конфигурация Nikto-плагинов, промышленная сборка для TeslaAI Genesis,
  поддерживающая строгий контроль загрузки, включение по условиям, ACL и безопасность.

global:
  default_enabled: false
  plugin_timeout: 15
  isolation_mode: sandboxed
  signature_verification: true
  log_level: info
  retry_failed_plugins: 2

security:
  gpg_signature_required: true
  signature_public_keys_path: "/etc/nikto/pubkeys/"
  execution_policy:
    sandbox_mode: seccomp
    allowed_syscalls: [read, write, open, close, getpid, sendto]
    restricted_network: true
  allowed_languages: [perl, python3, rust]

plugins:
  - id: xss_reflected
    name: "Reflected XSS Detector"
    path: plugins/client_side/check_xss.pl
    enabled: true
    severity: high
    priority: 10
    tags: [xss, client-side, injection]
    roles_allowed: [scanner, analyst]
    triggers:
      - method: GET
        match_url: "/search"
        match_params: ["q"]
    dependencies: []
    output:
      format: [stdout, json]
      log: true

  - id: exposed_git
    name: "Exposed .git Scanner"
    path: plugins/common/git_exposed.pl
    enabled: false
    severity: medium
    priority: 6
    tags: [information-disclosure, source-leak]
    roles_allowed: [scanner]
    triggers:
      - method: GET
        match_url: "/.git/config"
    dependencies: []
    output:
      format: [stdout]
      log: true

  - id: rce_debug
    name: "RCE Debug Endpoint Detector"
    path: plugins/server_side/rce_debug_exec.pl
    enabled: true
    severity: critical
    priority: 1
    tags: [rce, debug, critical]
    roles_allowed: [root, analyst]
    dependencies: []
    conditions:
      only_if_env: production
    output:
      format: [stdout, json, alert]
      log: true

  - id: custom_vuln_loader
    name: "Custom Vulnerability Loader"
    path: plugins/config/custom_loader.pl
    enabled: true
    severity: low
    priority: 9
    tags: [config, loader]
    roles_allowed: [admin]
    dependencies: ["custom_vulns.json"]
    output:
      format: [stdout]
      log: true

telemetry:
  send_metrics: false
  anonymized: true
  metrics_output_path: /var/log/nikto/metrics/

maintenance:
  update_check_interval_hours: 12
  plugin_health_monitoring: true
  plugin_reload_on_change: true
  admin_contact: "security@teslaai.gen"

