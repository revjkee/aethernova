version: "1.0-industrial"
description: >
  Профили сканирования для Nikto с поддержкой режима TeslaAI. 
  Предназначены для управления интенсивностью, глубиной, допустимыми модулями и рисками.

default_profile: "stealth"

profiles:
  stealth:
    description: "Минимально заметный профиль для обхода WAF/IDS"
    timeout: 4
    rate_limit: 0.5             # задержка между запросами (сек)
    max_concurrent_requests: 1
    allowed_plugins:
      - xss_reflected
      - headers_security
      - server_banner
    excluded_plugins:
      - rce_debug
    vendor_filter:
      allow: ["Apache", "nginx"]
    rules:
      avoid_rate_triggering: true
      obfuscate_payloads: true
      header_randomization: true
    roles_allowed: ["scanner", "stealth"]

  aggressive:
    description: "Полный профиль с максимумом атакующих техник"
    timeout: 15
    rate_limit: 0.0
    max_concurrent_requests: 10
    allowed_plugins: ["*"]
    excluded_plugins: []
    vendor_filter:
      deny: ["IIS"]
    rules:
      full_path_disclosure: true
      dangerous_payloads_enabled: true
    roles_allowed: ["pentester", "root"]

  full:
    description: "Глубокое медленное сканирование всех доступных уязвимостей"
    timeout: 10
    rate_limit: 1.0
    max_concurrent_requests: 3
    allowed_plugins:
      - "*"
    excluded_plugins: []
    vendor_filter:
      allow: ["*"]
    rules:
      log_every_response: true
      enable_redirect_follow: true
    roles_allowed: ["scanner", "analyst", "admin"]

  custom_low_risk:
    description: "Профиль для SOC без активных атак"
    timeout: 5
    rate_limit: 0.7
    max_concurrent_requests: 2
    allowed_plugins:
      - server_info
      - ssl_checks
      - headers_security
    excluded_plugins:
      - rce_debug
      - xss_reflected
    rules:
      no_http_post: true
      disable_payloads: true
    roles_allowed: ["soc", "viewer"]

policy:
  enforce_signature_check: true
  enforce_acl: true
  block_profile_switch_runtime: false
  audit_log_enabled: true
  log_path: "/var/log/nikto/profile_usage.log"
  alert_on_critical_profile_usage: true
