{
  // path: veilmind-core/.vscode/launch.json
  // VS Code debug configurations for industrial Python project
  "version": "0.2.0",
  "configurations": [
    {
      "name": "App: FastAPI (uvicorn) — dev",
      "type": "python",
      "request": "launch",
      "module": "uvicorn",
      "args": [
        "veilmind_core.app:app",
        "--host", "0.0.0.0",
        "--port", "${input:uvicornPort}",
        "--reload"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONUNBUFFERED": "1",
        "PYTHONPATH": "${workspaceFolder}/src",
        "UVICORN_RELOAD": "true",
        "LOG_LEVEL": "info"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true,
      "logToFile": true
    },
    {
      "name": "App: FastAPI (uvicorn) — prod flags",
      "type": "python",
      "request": "launch",
      "module": "uvicorn",
      "args": [
        "veilmind_core.app:app",
        "--host", "0.0.0.0",
        "--port", "${input:uvicornPort}",
        "--workers", "4",
        "--no-server-header",
        "--proxy-headers"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONUNBUFFERED": "1",
        "PYTHONPATH": "${workspaceFolder}/src",
        "LOG_LEVEL": "warning"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true,
      "logToFile": true
    },
    {
      "name": "Tests: pytest (current file)",
      "type": "python",
      "request": "launch",
      "module": "pytest",
      "args": [
        "-q",
        "${file}"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src",
        "PYTEST_ADDOPTS": "-q"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "Tests: pytest (folder)",
      "type": "python",
      "request": "launch",
      "module": "pytest",
      "args": [
        "-q",
        "${relativeFileDirname}"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "Tests: pytest + coverage",
      "type": "python",
      "request": "launch",
      "module": "pytest",
      "args": [
        "-q",
        "--maxfail=1",
        "--disable-warnings",
        "--cov=veilmind_core",
        "--cov-report=term-missing",
        "--cov-report=xml",
        "tests"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "Script: current file (module if possible)",
      "type": "python",
      "request": "launch",
      "program": "${file}",
      "module": "",
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "Module: run as python -m <module>",
      "type": "python",
      "request": "launch",
      "module": "${input:pythonModuleName}",
      "args": [],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "gRPC: server (python -m veilmind_core.grpc_server)",
      "type": "python",
      "request": "launch",
      "module": "veilmind_core.grpc_server",
      "args": [
        "--bind", "0.0.0.0:${input:grpcPort}"
      ],
      "cwd": "${workspaceFolder}",
      "envFile": "${workspaceFolder}/.env",
      "env": {
        "PYTHONPATH": "${workspaceFolder}/src",
        "GRPC_VERBOSITY": "info"
      },
      "console": "integratedTerminal",
      "justMyCode": false,
      "subProcess": true
    },
    {
      "name": "Attach: Local process (by PID)",
      "type": "python",
      "request": "attach",
      "processId": "${command:pickProcess}",
      "justMyCode": false,
      "subProcess": true,
      "logToFile": true
    },
    {
      "name": "Attach: debugpy (localhost:5678)",
      "type": "python",
      "request": "attach",
      "connect": {
        "host": "localhost",
        "port": 5678
      },
      "pathMappings": [
        {
          "localRoot": "${workspaceFolder}",
          "remoteRoot": "/app"  // подстройте под контейнер/VM
        }
      ],
      "justMyCode": false,
      "subProcess": true,
      "logToFile": true
    },
    {
      "name": "Attach: Container/VM (host & port input)",
      "type": "python",
      "request": "attach",
      "connect": {
        "host": "${input:remoteHost}",
        "port": "${input:remotePort}"
      },
      "pathMappings": [
        {
          "localRoot": "${workspaceFolder}",
          "remoteRoot": "${input:remoteRoot}"
        }
      ],
      "justMyCode": false,
      "subProcess": true,
      "logToFile": true
    }
  ],
  "compounds": [
    {
      "name": "App + Tests (watch separate)",
      "configurations": [
        "App: FastAPI (uvicorn) — dev",
        "Tests: pytest (folder)"
      ],
      "stopAll": true
    },
    {
      "name": "gRPC + App",
      "configurations": [
        "gRPC: server (python -m veilmind_core.grpc_server)",
        "App: FastAPI (uvicorn) — dev"
      ],
      "stopAll": true
    }
  ],
  "inputs": [
    {
      "id": "uvicornPort",
      "type": "promptString",
      "description": "Uvicorn port",
      "default": "8000"
    },
    {
      "id": "grpcPort",
      "type": "promptString",
      "description": "gRPC port",
      "default": "50051"
    },
    {
      "id": "pythonModuleName",
      "type": "promptString",
      "description": "Module to run as `python -m <module>`",
      "default": "veilmind_core.cli"
    },
    {
      "id": "remoteHost",
      "type": "promptString",
      "description": "Remote host for debugpy attach",
      "default": "127.0.0.1"
    },
    {
      "id": "remotePort",
      "type": "promptString",
      "description": "Remote port for debugpy attach",
      "default": "5678"
    },
    {
      "id": "remoteRoot",
      "type": "promptString",
      "description": "Remote project root (inside container/VM)",
      "default": "/app"
    }
  ]
}
